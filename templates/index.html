<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
            crossorigin="anonymous"></script>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css"
          href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css"/>

    <script src="https://kit.fontawesome.com/b1c5ccd7ac.js" crossorigin="anonymous"></script>

    <title>Playlist Bibimbap</title>

    <style>
        * {
            font-family: 'Pretendard Variable';
        }


        /*추후 수정 예정인 부분입니다*/
        .cover {
            color: goldenrod;
            width: 100%;
            height: 500px;

            background-color: #fcc221;
            background-size: cover;
            background-position: center;

            color: black;


            display: flex;
            flex-direction: column;
            position: relative;


        }

        .cover_bibimbap {
            margin: 10px;
            text-align: left;
        }

        .cover_title {
            margin-top: 25px;
            text-align: center;

        }


    </style>

    <script>
        $(document).ready(function () {
            listing();
        });

        function listing() {
            $('#cards-box').empty()
            $.ajax({
                type: 'GET',
                url: '/playlist',
                data: {},
                success: function (response) {
                    let rows = response['playlist']
                    for (let i = 0; i < rows.length; i++) {
                        let image = rows[i]['image']
                        let track = rows[i]['track']
                        let artists = rows[i]['artists']
                        let count = rows[i]['count']
                        let likes = rows[i]['likes']


                        let temp_html = ` <div class="col">
                                            <div class="card">
                                             <img src="${image}" class="card-img-top">
                                              <div class="card-body">
                                               <h5 class="card-title">"${track}"</h5>
                                               <p class="card-text">${artists}</p>
                                                 <p>${likes}</p>
                                                <p>${count}</p>
                                            </div>
                                         </div>
                                         </div>`
                        $('#cards-box').append(temp_html)
                    }
                }
            })
        }

        function add_to_playlists() {
            let track = $('#track').val()
            let date = $('#date_input').val()
            let hour = $('#hour_input').val()
            $.ajax({
                type: 'POST',
                url: '/playlist',
                data: {track_input: track, date_input: date, hour_input: hour},
                success: function (response) {
                    alert(response['msg'])
                    window.location.reload()

                }
            });
        }


    </script>

</head>
<body>

<div class="cover">
    <div class="cover_bibimbap">
        <b>Playlist Bibimbap</b>
    </div>
    <div class="cover_title">
        <h1><b>지금 듣고 있는 노래<br>모아모아 함께 들어요!</b></h1>

    </div>

    <div class="input-group mb-3" style="width: 60%; align-self: center; margin-top: 20px;">
        <input id="track_input" type="text" class="form-control" placeholder="지금 듣고 있는 노래를 검색해 노래를 모아보세요!"
               aria-label="지금 듣고 있는 노래를 검색해 노래를 모아보세요!"
               aria-describedby="노래 제목을 검색한 뒤 검색 버튼을 눌러주세요">

        <button class="btn btn-dark" onclick="add_to_playlists()" type="submit" id="search_button">
            <i class="fa-solid fa-magnifying-glass" style="color:white;"></i>
        </button>

        <script>
            document.getElementById("search_button").addEventListener("click", function () {
                var date_input = new Date();
                var hour_input = date_input.getHours();

            });
        </script>


    </div>
    <div class="container-fluid">
        <div class="row row-cols-1 row-cols-md-2 g-3" id="cards-box">

        </div>
    </div>


</div>


</body>
</html>